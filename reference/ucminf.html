<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>General-Purpose Unconstrained Non-Linear Optimization — ucminf • ucminf</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="General-Purpose Unconstrained Non-Linear Optimization — ucminf"><meta property="og:description" content="An algorithm for general-purpose unconstrained non-linear optimization. The algorithm
  is of quasi-Newton type with BFGS updating of the inverse
  Hessian and soft line search with a trust region type monitoring of the
  input to the line search algorithm. The interface of &amp;#8216;ucminf&amp;#8217; is designed for
  easy interchange with &amp;#8216;optim&amp;#8217;."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ucminf</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1-5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>General-Purpose Unconstrained Non-Linear Optimization</h1>
    
    <div class="hidden name"><code>ucminf.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>An algorithm for general-purpose unconstrained non-linear optimization. The algorithm
  is of quasi-Newton type with BFGS updating of the inverse
  Hessian and soft line search with a trust region type monitoring of the
  input to the line search algorithm. The interface of ‘ucminf’ is designed for
  easy interchange with ‘optim’.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ucminf</span><span class="op">(</span><span class="va">par</span>, <span class="va">fn</span>, gr <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, hessian<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>par</dt>
<dd><p>Initial estimate of minimum for <code>fn</code>.</p></dd>

  <dt>fn</dt>
<dd><p>Objective function to be minimized.</p></dd>

  <dt>gr</dt>
<dd><p>Gradient of objective function. If <code>NULL</code> a finite difference
    approximation is used.</p></dd>

  <dt>...</dt>
<dd><p>Optional arguments passed to the objective and gradient functions.</p></dd>

  <dt>control</dt>
<dd><p>A list of control parameters. See ‘Details’.</p></dd>

  <dt>hessian</dt>
<dd><p>Integer value:</p><dl><dt>0</dt>
<dd><p>No hessian approximation is returned.</p></dd>

      <dt>1</dt>
<dd><p>Returns a numerical approximation of the Hessian
	using ‘hessian’ in the package ‘numDeriv’.</p></dd>

      <dt>2</dt>
<dd><p>Returns final approximation of the inverse Hessian based on the series of BFGS
	updates during optimization.</p></dd>

      <dt>3</dt>
<dd><p>Same at 2, but will also return the Hessian (the inverse of 2).</p></dd>

    
</dl><p>If a <code>TRUE</code> or <code>FALSE</code> value is given it will switch
  between option 1 or 0.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The algorithm is documented in (Nielsen, 2000) (see References
  below) together with a comparison to the Fortran subroutine
  ‘MINF’ and the Matlab function ‘fminunc’. The
  implementation of ‘ucminf’ in <span style="R">R</span> uses the
  original Fortran version of the algorithm.</p>
<p>The interface in R is designed so that it is very easy to switch
  between using ‘ucminf’ and ‘<a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a>’. The
  arguments <code>par</code>, <code>fn</code>, <code>gr</code>, and <code>hessian</code>
  are all the same (with a few extra options for <code>hessian</code> in
  ‘ucminf’). The difference is that there is no <code>method</code>
  argument in ‘ucminf’ and that some of the components in the
  <code>control</code> argument are different due to differences in the
  algorithms.</p>
<p>The algorithm can be given an initial estimate of the Hessian for the
  optimization and it is possible to get the final approximation of the
  Hessian based on the series of BFGS updates. This extra functionality
  may be useful for optimization in a series of related problems.</p>
<p>The functions <code>fn</code> and <code>gr</code> can return <code>Inf</code> or <code>NaN</code>
  if the functions cannot be evaluated at the supplied value, but the
  functions must be computable at the initial value. The functions
  are not allowed to return <code>NA</code>. Any names given to <code>par</code> will be
  copied to the vectors passed to <code>fn</code> and <code>gr</code>. No
  other attributes of <code>par</code> are copied over.</p>
<p>The <code>control</code> argument is a list that can supply any of the
  following components:</p>
<p></p><dl><dt><code>trace</code></dt>
<dd><p>If trace is positive then detailed tracing information is printed for each iteration.</p></dd>

    <dt><code>grtol</code></dt>
<dd><p>The algorithm stops when
      \(||F'(x)||_\infty \leq \) grtol, that
      is when the largest absolute value of the gradient is less than
      grtol. Default value is <code>grtol = 1e-6</code>.</p></dd>

    <dt><code>xtol</code></dt>
<dd><p>The algorithm stops when \(||x-x_p||_2 \leq
	\textrm{xtol}\cdot(\textrm{xtol} +
      ||x||_2)\), where \(x_p\) and \(x\) are the
      previous and current estimate of the minimizer. Thus the algorithm
      stops when the last relative step length is
      sufficiently small. Default value is <code>xtol = 1e-12</code>.</p></dd>

    <dt><code>stepmax</code></dt>
<dd><p>Initial maximal allowed step length (radius of
      trust-region). The value is updated during the
      optimization. Default value is <code>stepmax = 1</code>.</p></dd>

    <dt><code>maxeval</code></dt>
<dd><p>The maximum number of function evaluations. A function evaluation
      is counted as one evaluation of the objective function and of the
      gradient function. Default value is <code>maxeval = 500</code>.</p></dd>

    <dt><code>grad</code></dt>
<dd><p>Either ‘forward’ or ‘central’. Controls
      the type of finite difference approximation to be used for the
      gradient if no gradient function is given in the input argument
      ‘gr’. Default value is <code>grad = 'forward'</code>.</p></dd>

    <dt><code>gradstep</code></dt>
<dd><p>Vector of length 2. The step length in finite
      difference approximation for the gradient. Step length is
      \(|x_i|\cdot\textrm{gradstep[1]+gradstep[2]}\).
      Default value is <code>gradstep = c(1e-6, 1e-8)</code>.</p></dd>

    <dt><code>invhessian.lt</code></dt>
<dd><p>A vector with an initial approximation to the lower triangle of the
      inverse Hessian. If not given, the inverse Hessian is initialized
      as the identity matrix. If <code>H0</code> is the initial hessian matrix then
      the lower triangle of the inverse of <code>H0</code> can be found as
      <code>invhessian.lt = solve(H0)[lower.tri(H0,diag=TRUE)]</code>.</p></dd>

  
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <dl><dt>par</dt>
<dd><p>Computed minimizer.</p></dd>

  <dt>value</dt>
<dd><p>Objective function value at computed minimizer.</p></dd>

  <dt>convergence</dt>
<dd><p>Flag for reason of termination:</p><dl><dt>1</dt>
<dd><p>Stopped by small gradient (grtol).</p></dd>

      <dt>2</dt>
<dd><p>Stopped by small step (xtol).</p></dd>

      <dt>3</dt>
<dd><p>Stopped by function evaluation limit (maxeval).</p></dd>

      <dt>4</dt>
<dd><p>Stopped by zero step from line search</p></dd>

      <dt>-2</dt>
<dd><p>Computation did not start: length(par) = 0.</p></dd>

      <dt>-4</dt>
<dd><p>Computation did not start: stepmax is too small.</p></dd>

      <dt>-5</dt>
<dd><p>Computation did not start: grtol or xtol &lt;= 0.</p></dd>

      <dt>-6</dt>
<dd><p>Computation did not start: maxeval &lt;= 0.</p></dd>

      <dt>-7</dt>
<dd><p>Computation did not start: given Hessian not pos. definite.</p></dd>

    
</dl><p></p></dd>

  <dt>message</dt>
<dd><p>String with reason of termination.</p></dd>

  <dt>hessian, invhessian</dt>
<dd><p>Estimate of (inv.) Hessian at computed minimizer. The type of
    estimate is given by the input argument ‘hessian’.</p></dd>

  <dt>invhessian.lt</dt>
<dd><p>The lower triangle of the final approximation to the
    inverse Hessian based on the series of BFGS	updates during optimization.</p></dd>

  <dt>info</dt>
<dd><p>Information about the search:</p><dl><dt>maxgradient</dt>
<dd><p>\(||F'(x)||_\infty\), the
	largest element in the absolute
	value of the gradient at the computed minimizer.</p></dd>

      <dt>laststep</dt>
<dd><p>Length of last step.</p></dd>

      <dt>stepmax</dt>
<dd><p>Final maximal allowed step length.</p></dd>

      <dt>neval</dt>
<dd><p>Number of calls to both objective and gradient function.</p></dd>

    
</dl><p></p></dd>

</dl></div>
    <div id="author">
    <h2>Author</h2>
    

<p>‘UCMINF’ algorithm design and Fortran code by Hans Bruun Nielsen.</p>
<p>Implementation in <span style="R">R</span> by Stig B. Mortensen, <a href="mailto:stigbm@gmail.com">stigbm@gmail.com</a>.</p>
<p>Modifications by Douglas Bates &lt;bates@stat.wisc.edu&gt;, Nov. 2010, to
  support nested optimization and correct issues with printing on Windows.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>, <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a></code>, <code><a href="https://rdrr.io/r/stats/nlm.html" class="external-link">nlm</a></code>.</p></div>
    </div>
    <div id="references">
    <h2>References</h2>
    

<p>Nielsen, H. B. (2000) ‘UCMINF - An Algorithm For Unconstrained,
  Nonlinear Optimization’, Report IMM-REP-2000-18,
  Department of Mathematical Modelling, Technical University of
  Denmark. <a href="http://orbit.dtu.dk/recid/200975" class="external-link">http://orbit.dtu.dk/recid/200975</a>.</p>
<p>The original Fortran
  source code can be found at
  <a href="http://www2.imm.dtu.dk/projects/hbn_software/ucminf.f" class="external-link">http://www2.imm.dtu.dk/projects/hbn_software/ucminf.f</a>. The code has been
  slightly modified in this package to be suitable for use with <span style="R">R</span>.</p>
<p>The general structure of the implementation in <span style="R">R</span> is based on the
  package ‘FortranCallsR’ by Diethelm Wuertz.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Rosenbrock Banana function</span></span></span>
<span class="r-in"><span><span class="va">fR</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">gR</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">400</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     <span class="fl">200</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#  Find minimum and show trace</span></span></span>
<span class="r-in"><span><span class="fu">ucminf</span><span class="op">(</span>par <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">.5</span><span class="op">)</span>, fn <span class="op">=</span> <span class="va">fR</span>, gr <span class="op">=</span> <span class="va">gR</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in .Call(mfopt, rho):</span> NULL value passed as symbol address</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stig Bousgaard Mortensen.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

